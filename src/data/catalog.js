'use strict';

// ВАЖНО: картинки положи в public/assets/products/...
// Если у тебя с Диска будут реальные имена файлов — просто замени image на нужные.

const categories = [
  'Кирпич облицовочный',
  'Кирпич рядовой',
  'Керамический блок',
  'Клинкер и ступени',
  'Растворы и смеси',
  'Сопутствующие товары'
];

function slugify(str) {
  return String(str)
    .toLowerCase()
    .replace(/ё/g, 'е')
    .replace(/[^a-z0-9а-я\s-]/g, '')
    .trim()
    .replace(/\s+/g, '-')
    .replace(/-+/g, '-');
}

function makeProduct(p) {
  const slug = p.slug || slugify(p.title);
  return {
    id: p.id,
    slug,
    title: p.title,
    category: p.category,
    image: p.image,
    gallery: p.gallery || [p.image],
    short: p.short,
    description: p.description,
    specs: p.specs,
    color: p.color || '',
    format: p.format || '',
    tags: p.tags || [],
    priceRub: p.priceRub || null,
    unit: p.unit || 'шт.',
    availability: p.availability || 'В наличии',
    isFeatured: !!p.isFeatured,
    isBestseller: !!p.isBestseller
  };
}

const lorem = {
  delivery: 'Доставка на объект от 1 поддона. Возможен самовывоз со склада. Подбор логистики под объем и подъездные пути.',
  docs: 'Работаем с физ. и юр. лицами. Закрывающие документы, договор, счет. По запросу — паспорта качества и сертификаты.',
  consult: 'Поможем подобрать оттенок/фактуру, рассчитать количество по проекту, учтем добор и запас, подскажем узлы кладки.'
};

// Большой каталог (60+ позиций)
const raw = [
  // Облицовочный
  {
    id: 101, category: 'Кирпич облицовочный',
    title: 'Кирпич облицовочный “Баварская кладка” микс 1NF',
    image: '/public/assets/products/oblic-1.jpg',
    short: 'Эффектный микс оттенков для фасада. Ровная геометрия, стабильный цвет.',
    description: `Фасадный облицовочный кирпич с выразительным рисунком “баварской кладки”. Подходит для частных домов, заборов и акцентных элементов. ${lorem.consult} ${lorem.docs}`,
    specs: [
      ['Формат', '1NF'], ['Размер', '250×120×65 мм'], ['Марка прочности', 'М150–М200'],
      ['Морозостойкость', 'F100'], ['Водопоглощение', '6–10%'], ['Поверхность', 'гладкая/слегка рельефная']
    ],
    color: 'микс коричневый/красный/графит',
    format: '1NF',
    tags: ['фасад', 'баварская', 'премиум'],
    priceRub: 34,
    unit: 'шт.',
    isFeatured: true,
    isBestseller: true
  },
  {
    id: 102, category: 'Кирпич облицовочный',
    title: 'Кирпич облицовочный “Белый айвори” 1NF',
    image: '/public/assets/products/oblic-2.jpg',
    short: 'Светлый фасадный кирпич для современного дома. Хорошо сочетается с деревом и металлом.',
    description: `Аккуратный светлый кирпич для фасада и интерьера. Рекомендуем использовать цветной кладочный раствор для чистого шва. ${lorem.delivery} ${lorem.docs}`,
    specs: [
      ['Формат', '1NF'], ['Размер', '250×120×65 мм'], ['Марка прочности', 'М150'],
      ['Морозостойкость', 'F75–F100'], ['Поверхность', 'гладкая'], ['Оттенок', 'айвори/молочный']
    ],
    color: 'айвори',
    format: '1NF',
    tags: ['фасад', 'светлый', 'минимализм'],
    priceRub: 32,
    unit: 'шт.',
    isFeatured: true
  },
  {
    id: 103, category: 'Кирпич облицовочный',
    title: 'Кирпич облицовочный “Серый графит” 1NF',
    image: '/public/assets/products/oblic-3.jpg',
    short: 'Строгий графитовый оттенок. Для “сканди” и хай-тек фасадов.',
    description: `Графитовый кирпич — один из самых востребованных цветов. Смотрится дорого, хорошо держит тон. ${lorem.consult} ${lorem.delivery}`,
    specs: [
      ['Формат', '1NF'], ['Размер', '250×120×65 мм'], ['Марка прочности', 'М175'],
      ['Морозостойкость', 'F100'], ['Поверхность', 'гладкая'], ['Совет', 'используйте темный/серый раствор']
    ],
    color: 'графит',
    format: '1NF',
    tags: ['фасад', 'графит', 'хит'],
    priceRub: 36,
    unit: 'шт.',
    isBestseller: true
  },

  // Рядовой
  {
    id: 201, category: 'Кирпич рядовой',
    title: 'Кирпич рядовой керамический М150 1NF',
    image: '/public/assets/products/ryad-1.jpg',
    short: 'Надёжный рядовой кирпич для несущих стен, перегородок и хозяйственных построек.',
    description: `Классический рядовой кирпич для кладки стен и перегородок. Оптимален по цене/прочности. ${lorem.delivery} ${lorem.docs}`,
    specs: [
      ['Формат', '1NF'], ['Марка', 'М150'], ['Морозостойкость', 'F50'],
      ['Назначение', 'стены/перегородки'], ['Упаковка', 'на поддоне']
    ],
    color: 'красный',
    format: '1NF',
    tags: ['рядовой', 'стены'],
    priceRub: 16,
    unit: 'шт.',
    isFeatured: true
  },
  {
    id: 202, category: 'Кирпич рядовой',
    title: 'Кирпич рядовой утолщённый 1,4NF',
    image: '/public/assets/products/ryad-2.jpg',
    short: 'Быстрее кладка — меньше швов. Удобно на объёмах.',
    description: `Утолщенный формат ускоряет кладку и сокращает количество швов. Подходит для больших объёмов строительства. ${lorem.consult}`,
    specs: [
      ['Формат', '1,4NF'], ['Марка', 'М150'], ['Морозостойкость', 'F50'],
      ['Преимущество', 'скорость кладки'], ['Упаковка', 'поддон']
    ],
    color: 'красный',
    format: '1,4NF',
    tags: ['рядовой', 'быстро'],
    priceRub: 22,
    unit: 'шт.'
  },

  // Керамические блоки
  {
    id: 301, category: 'Керамический блок',
    title: 'Блок керамический тёплый 10,7NF (380 мм)',
    image: '/public/assets/products/block-1.jpg',
    short: 'Тёплая керамика для несущих стен. Хорошая геометрия, скорость кладки.',
    description: `Поризованный керамический блок для энергоэффективных стен. Быстрое возведение, меньше раствора, стабильная геометрия. ${lorem.consult} ${lorem.docs}`,
    specs: [
      ['Формат', '10,7NF'], ['Толщина', '380 мм'], ['Назначение', 'несущие стены'],
      ['Теплотехника', 'тёплая керамика'], ['Особенность', 'паз-гребень']
    ],
    color: 'терракотовый',
    format: '10,7NF',
    tags: ['блок', 'тёплая керамика', 'дом'],
    priceRub: 265,
    unit: 'шт.',
    isFeatured: true,
    isBestseller: true
  },
  {
    id: 302, category: 'Керамический блок',
    title: 'Блок керамический 12,4NF (440 мм) поризованный',
    image: '/public/assets/products/block-2.jpg',
    short: 'Для тёплых стен. Рекомендуется под однослойную кладку с правильным раствором.',
    description: `Толстый поризованный блок для повышения сопротивления теплопередаче. Подходит для частного домостроения. ${lorem.consult} ${lorem.delivery}`,
    specs: [
      ['Формат', '12,4NF'], ['Толщина', '440 мм'], ['Профиль', 'паз-гребень'],
      ['Кладка', 'тонкошовная/теплая смесь'], ['Скорость', 'в 3–4 раза быстрее кирпича']
    ],
    color: 'терракотовый',
    format: '12,4NF',
    tags: ['блок', 'энергоэффективность'],
    priceRub: 315,
    unit: 'шт.'
  },
  {
    id: 303, category: 'Керамический блок',
    title: 'Перегородочный блок 5,7NF (100 мм)',
    image: '/public/assets/products/block-3.jpg',
    short: 'Лёгкие перегородки. Экономия времени и раствора.',
    description: `Перегородочный керамический блок — быстро и аккуратно. Для внутренних перегородок, где важна геометрия. ${lorem.docs}`,
    specs: [
      ['Формат', '5,7NF'], ['Толщина', '100 мм'], ['Назначение', 'перегородки'],
      ['Преимущество', 'скорость'], ['Совет', 'армирование по проекту']
    ],
    color: 'терракотовый',
    format: '5,7NF',
    tags: ['перегородки', 'быстро'],
    priceRub: 165,
    unit: 'шт.'
  },

  // Клинкер / ступени
  {
    id: 401, category: 'Клинкер и ступени',
    title: 'Клинкерная ступень “Графит” (наружная)',
    image: '/public/assets/products/step-1.jpg',
    short: 'Износостойкая ступень для крыльца и террасы. Не боится влаги и морозов.',
    description: `Клинкерная ступень для наружных работ: высокая износостойкость, низкое водопоглощение. ${lorem.delivery} ${lorem.docs}`,
    specs: [
      ['Назначение', 'крыльцо/терраса'], ['Морозостойкость', 'высокая'], ['Поверхность', 'антискользящая'],
      ['Цвет', 'графит'], ['Монтаж', 'клей для клинкера']
    ],
    color: 'графит',
    format: '—',
    tags: ['клинкер', 'ступени'],
    priceRub: 1950,
    unit: 'шт.',
    isBestseller: true
  },

  // Растворы
  {
    id: 501, category: 'Растворы и смеси',
    title: 'Кладочный раствор цветной “Серый” 25 кг',
    image: '/public/assets/products/mix-1.jpg',
    short: 'Ровный шов, стабильный цвет. Для облицовочного кирпича.',
    description: `Цветной кладочный раствор для облицовки: пластичность, прочность, аккуратный шов. ${lorem.docs}`,
    specs: [
      ['Фасовка', '25 кг'], ['Цвет', 'серый'], ['Назначение', 'облицовка'],
      ['Расход', 'зависит от шва'], ['Совет', 'соблюдать водоцементное отношение']
    ],
    color: 'серый',
    format: 'мешок',
    tags: ['раствор', 'цветной шов'],
    priceRub: 790,
    unit: 'мешок'
  },

  // Сопутствующие
  {
    id: 601, category: 'Сопутствующие товары',
    title: 'Сетка кладочная 50×50 (оцинк.) 1×2 м',
    image: '/public/assets/products/acc-1.jpg',
    short: 'Для армирования кладки и снижения трещинообразования.',
    description: `Оцинкованная кладочная сетка для армирования стен и перегородок. ${lorem.docs}`,
    specs: [
      ['Размер карты', '1×2 м'], ['Ячейка', '50×50'], ['Материал', 'оцинковка'],
      ['Применение', 'армирование кладки']
    ],
    color: 'металл',
    format: 'лист',
    tags: ['армирование'],
    priceRub: 420,
    unit: 'лист'
  }
];

// Добиваем каталог автоматически “пачкой” позиций (чтобы было много товаров в демо)
const auto = [];
let id = 700;

const palettes = [
  { color: 'терракота', tag: 'классика' },
  { color: 'солома', tag: 'тёплый' },
  { color: 'шоколад', tag: 'тёмный' },
  { color: 'графит', tag: 'современный' },
  { color: 'айвори', tag: 'светлый' }
];

const formats = ['0,7NF', '1NF', '1,4NF', '2,1NF'];

for (let i = 0; i < 36; i++) {
  const pal = palettes[i % palettes.length];
  const fmt = formats[i % formats.length];
  const cat = i % 2 === 0 ? 'Кирпич облицовочный' : 'Кирпич рядовой';

  auto.push({
    id: id++,
    category: cat,
    title: `${cat === 'Кирпич облицовочный' ? 'Кирпич облицовочный' : 'Кирпич строительный'} “${pal.color}” ${fmt}`,
    image: `/public/assets/products/auto-${(i % 12) + 1}.jpg`,
    short: `Оттенок: ${pal.color}. Формат: ${fmt}. Подходит для домов, заборов и малых архитектурных форм.`,
    description: `${lorem.consult} ${lorem.delivery} ${lorem.docs}`,
    specs: [
      ['Формат', fmt],
      ['Марка прочности', cat === 'Кирпич рядовой' ? 'М125–М150' : 'М150–М200'],
      ['Морозостойкость', cat === 'Кирпич рядовой' ? 'F35–F50' : 'F75–F100'],
      ['Оттенок', pal.color],
      ['Поверхность', cat === 'Кирпич рядовой' ? 'рядовой' : 'гладкая/рельеф']
    ],
    color: pal.color,
    format: fmt,
    tags: [pal.tag],
    priceRub: cat === 'Кирпич рядовой' ? 14 + (i % 6) : 28 + (i % 10),
    unit: 'шт.',
    isFeatured: i % 9 === 0,
    isBestseller: i % 7 === 0
  });
}

// ещё блоки/сопутствующие для полноты
for (let i = 0; i < 18; i++) {
  const thick = [250, 380, 440, 510][i % 4];
  auto.push({
    id: id++,
    category: 'Керамический блок',
    title: `Блок керамический поризованный ${thick} мм`,
    image: `/public/assets/products/block-auto-${(i % 6) + 1}.jpg`,
    short: `Тёплая керамика, профиль паз-гребень. Толщина ${thick} мм.`,
    description: `Поризованные блоки для быстрого строительства. Подходит для несущих стен/перегородок в зависимости от толщины. ${lorem.consult} ${lorem.docs}`,
    specs: [
      ['Толщина', `${thick} мм`],
      ['Профиль', 'паз-гребень'],
      ['Назначение', thick >= 380 ? 'несущие стены' : 'перегородки/внутренние стены'],
      ['Кладка', 'теплый раствор/тонкошовная смесь'],
      ['Важно', 'соблюдать перевязку и узлы по проекту']
    ],
    color: 'терракотовый',
    format: `${(i % 2) ? '10,7NF' : '12,4NF'}`,
    tags: ['блок', 'тёплая керамика'],
    priceRub: 170 + (i % 6) * 25,
    unit: 'шт.',
    isFeatured: i % 10 === 0
  });
}

const catalog = [...raw, ...auto].map(makeProduct);

function getProductBySlug(slug) {
  return catalog.find(p => p.slug === slug);
}

module.exports = {
  catalog,
  categories,
  getProductBySlug
};
